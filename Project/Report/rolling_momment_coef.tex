\section{Derivation of $C_{l}$ rolling moment coefficient}
In this part of the project the rolling moment coefficient of the J35 Draken is to be calculated.
For the simulation, the model of fig.\ref{fig:model} was used:

\begin{figure}[H]
    \begin{center}
        \includegraphics[width = \textwidth]{model.jpg} % Just THIS!!!
    \end{center}
    \caption{Picture of model during wind tunnel test}
    \label{fig:model}
\end{figure}

\subsection{Simulation Considerations}

The following can be stated when comparing the j35 Draken aircraft with the wind tunnel model used(~fig.\ref{fig:model}
\begin{itemize*}
    \item Apparently the major difference is the \textit{absence of the fin}. 
        This fact eventually caused considerable divergence between the values computed during the 
        simulation and the data extracted from Draken data diagramms provided.
    \item The wind tunnel model scale was 1:14.7 except for the bodywidth
        and noselength. 
\end{itemize*}


\subsection{Mathematical Modelling}
In order to proceed with the analysis and the computation of $C_{lp}, C_{l\beta} parameters$, 
a valid mathematical model needs to be derived first. 
If I implement the Newton's second law for the rolling movement
I can derive equation \ref{eqn:newton_angular}.

\begin{equation}
    \Sigma T = I_{xx}\ddot{\phi} \Rightarrow 
    L - C\dot{\phi} - k\phi = I_{xx}\ddot{\phi},
    \label{eqn:newton_angular}
\end{equation}

\noindent where $C\dot{\phi}$ is the moment exerted due to the (mechanical) damping and $k\phi$ is
the moment due to the (mechanical) spring stiffness of the device holding the airplane during the simulation.
For the calculation of the rolling moment the following equations can be used:
\begin{eqnarray}
    L &=& C_l q b S \label{eqn:roll_moment} \label{eqn:L}\\
    C_l &=&  C_{lp}\frac{pb}{2u} + C_{l\beta}\beta \label{eqn:cl}\\
    p &=&\dot{\phi} \notag\\
    q &=&  \frac{1}{2}\rho v^2 \notag
\end{eqnarray}

A sufficient model of calculating $C_l$ - the rolling moment coefficient - is given in equation
\ref{eqn:cl}. According to this, $C_l$ is a function of $C_{lp}$ the \textit{damping-in-roll}
coefficient and $C_{l\beta}$ the dihedral effect.
$C_{lp}$ expresses the resistance of the airplane to rolling 
\cite{etkin_dynamics_1972}, while $C_{l\beta}$ expresses the change in rolling moment 
coefficient per degree of change in the sideslip angle $\beta$. A sufficient relation to 
calculating $\beta$ can be the following:
\begin{equation}
    \beta = \alpha \phi
    \label{eqn:beta}
\end{equation}

If I now substitute the expression of rolling moment \ref{eqn:L} into the initial equation
\ref{eqn:newton_angular}, and move all the $\phi, \dot{\phi}$ terms to the other side of the equation
I can end up with the following second order differential equation:

\begin{equation}
    I_{xx}\ddot{\phi} + \dot{\phi}\big(C_{mech} - \frac{C_{lp}Sb^2q}{2u}\big) + \big(k - C_{l\beta}aqbS\big)\phi = 0
    \label{eqn:ode_used}
\end{equation}

The analytical solution of \ref{eqn:ode_used} for the general case of complex roots
(which is what I expect due to the oscillatory behavior of the model movement) is the following:

\begin{eqnarray}
    \phi &=&  c_1e^{\alpha' x}cos(\beta' x) + c_2e^{\alpha' x} sin(\beta' x) \label{eqn:phianal}\\
    \alpha' &=&  -\frac{\beta}{2\alpha} \notag\\
    \beta' &=&  \frac{\sqrt{4ac - b^2}}{2a} \notag\\
\end{eqnarray}

where $\alpha, \beta, c$ are the coefficients of \ref{eqn:ode_used} respectively:
\begin{eqnarray}
    \alpha &=& I_{xx} \notag\\
    \beta &=&  C_{mech} - \frac{C_{lp}Sb^2q}{2u} \notag\\
    c &=&  k - C_{l\beta}aqbS \notag
\end{eqnarray}

\noindent In order to get the analytical solution of the roll rate $\dot{\phi}$ I take the derivative 
of \ref{eqn:phianal}:

\begin{eqnarray}
    \dot{\phi} &=&   \big(-C_1 \beta' sin(\beta' x) + C_2 \beta' cos(\beta' x) \big) e^{\alpha' x} =\notag\\
     &=&  \beta'\big(-C_1+C_2\big)e^{\alpha'}x\big(sin(\beta'x) + cos(\beta'x)\big) = \notag\\
     &\Rightarrow& \big\{A = \beta' \big(-C_1+C_2\big) \quad \big\} \Rightarrow \notag\\
     \dot{\phi} &=& Ae^{\alpha'x}\big(sin(\beta'x) + cos(\beta'x)\big) \label{eqn:panal} = \notag\\
     &\Rightarrow&  \big\{asin(\theta) + bcos(\theta) = Rsin\big(\theta \pm \alpha\big)\big\}\Rightarrow \notag\\
     \dot{\phi} &=& Ae^{\alpha'x}\big(sin(\beta'x + \Theta \big) \label{eqn:panal} \label{eqn:panal}
\end{eqnarray}

\subsection{Derivation of \textit{damping-in-roll} derivative $C_{lp}$}

In order to derive the $C_{lp}$ parameter, I first need to extract information out of 
the experimental data gathered. The oscillation of the rolling motion can be modelled as a 
decaying sinusoidal function of time. Therefore I can fit an exponential sinusoidal function 
of the form~\ref{eqn:panal} in the data and estimate each parameter 
by using the least squares method.

The data fit procedure uses the Fourier transform to extract the basic frequency as well as the least squares method.
Figures~\ref{fig:datafit1},\ref{fig:datafit2} show some examples of the data fits that demonstrate the efficiency of the 
approximation algorithm used.

\begin{figure}[H]
        \centering
        \begin{subfigure}[b]{0.48\textwidth}
                \includegraphics[width=\textwidth]{datafit_clp1}
                \caption{V = 35 $\sfrac{m}{s}$}
                \label{fig:datafit1}
        \end{subfigure}%
        ~
        \begin{subfigure}[b]{0.48\textwidth}
                \includegraphics[width=\textwidth]{datafit_clp2}
                \caption{V = 45 $\sfrac{m}{s}$}
                \label{fig:datafit2}
        \end{subfigure}
\end{figure}

To derive only the value of the $C_{lp}$ parameter I have to take into account \textit{only the data for $\alpha = 0$},
because otherwise $C_{l\beta}$ starts to play a role in the behavior of the oscilation (see eq.~\ref{eqn:ode_used}).

In order to extract the maximum amount of data and be as accurate as possible I \textit{exploit all the $\alpha = 0$ measurements taken during the laboratory sessions.}
\footnote{The reader is encouraged to refer to stiff.m of the code part for the actual implementation}.

The procedure can be summarised in the next steps:
\begin{enumerate}
    \item Calculation of $C_{mech}, I_{xx}$\footnote{I know that $I_xx = \sqrt{\frac{k}{\omega^2}}$ where k
    has already been determined experimentally.} using one of the  $\alpha = 0 \& V = 0$ measurements available.
    \item Approximation of the n-v \footnote{n is the damping coefficient, equivalent to $\beta'$ of eq.~\ref{eqn:panal}}curve by using a wide rage of velocities to calculate n-values and by using the least squares method.
    \item Calculation of the n-v  curve slope from which knowing every other quantity I can extract an estimation of the $C_{lp}$ value.
\end{enumerate}

Using this strategy I can now derive the approximation curve of the n-v points:
\begin{figure}[H]
    \begin{center}
        \includegraphics[width = \textwidth]{v_n_graph} % Just THIS!!!
    \end{center}
    \caption{Velocity - Damping approximation curve}
    \label{fig:v_n_graph}
\end{figure}

\noindent From the above graph and using the methodology described in the previous steps I can now conclude to the value of $C_{lp}$:
\begin{equation}
    C_{lp} \simeq -0.190
\end{equation}

\noindent Since this value is (strictly) negative and is close to the data given for the real aircraft (for $\alpha = 0$), 
I can conclude that it is a logical estimation of the damping-in-roll coefficient.

\subsection{Derivation of the \textit{Dihedral effect} $C_{l\beta}$}
